{"ast":null,"code":"import _objectSpread from \"D:\\\\OceanTech\\\\nimpe\\\\Client-V2\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";\nimport _defineProperty from \"D:\\\\OceanTech\\\\nimpe\\\\Client-V2\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"D:\\\\OceanTech\\\\nimpe\\\\Client-V2\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"D:\\\\OceanTech\\\\nimpe\\\\Client-V2\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _inherits from \"D:\\\\OceanTech\\\\nimpe\\\\Client-V2\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _createSuper from \"D:\\\\OceanTech\\\\nimpe\\\\Client-V2\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"D:\\\\OceanTech\\\\nimpe\\\\Client-V2\\\\src\\\\app\\\\views\\\\sessions\\\\ForgotPassword.jsx\";\nimport React, { Component, Suspense } from \"react\";\nimport ConstantList from \"../../appConfig\";\nimport { Card, Grid, Button, withStyles, CircularProgress } from \"@material-ui/core\";\nimport { TextValidator, ValidatorForm } from \"react-material-ui-form-validator\";\nimport { connect } from \"react-redux\";\nimport { PropTypes } from \"prop-types\";\nimport { withRouter } from \"react-router-dom\";\nimport { forgotPassword, resetPassword } from './SessionService'; // import { resetPassword } from \"../../redux/actions/LoginActions\";\n\nimport { toast, ToastContainer } from 'react-toastify';\nimport { Redirect, Link } from 'react-router-dom';\n\nvar ForgotPassword = /*#__PURE__*/function (_Component) {\n  _inherits(ForgotPassword, _Component);\n\n  var _super = _createSuper(ForgotPassword);\n\n  function ForgotPassword() {\n    var _this;\n\n    _classCallCheck(this, ForgotPassword);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.state = {\n      email: '',\n      token: '',\n      newPassword: '',\n      confirmNewPassword: '',\n      emailCorrect: false\n    };\n\n    _this.handleChange = function (event) {\n      event.persist();\n\n      _this.setState(_defineProperty({}, event.target.name, event.target.value));\n    };\n\n    _this.handleFormSubmit = function (e) {\n      var t = _this.props.t;\n\n      if (!_this.state.emailCorrect) {\n        forgotPassword({\n          email: _this.state.email\n        }).then(function (data) {\n          console.log(data);\n          toast.success('Kiểm tra OTP trong email đăng ký');\n\n          _this.setState({\n            emailCorrect: true\n          });\n        }).catch(function (reason) {\n          var _reason$response;\n\n          if (((_reason$response = reason.response) === null || _reason$response === void 0 ? void 0 : _reason$response.status) === 400) {\n            toast.error('Email không tồn tại');\n          } else {\n            toast.error('Có lỗi xảy ra');\n          }\n\n          console.log(reason.message);\n        });\n      } else {\n        resetPassword(_objectSpread({}, _this.state)).then(function (data) {\n          console.log(data);\n\n          if (data.data.code === 200) {\n            toast.success('Thay đổi mật khẩu thành công');\n            setTimeout(function () {\n              _this.props.history.push(ConstantList.ROOT_PATH + \"session/signin\");\n            }, 1000);\n          } else {\n            toast.error(\"Th\\xF4ng tin kh\\xF4ng ch\\xEDnh x\\xE1c\");\n          }\n        }).catch(function (err) {\n          toast.error(err.message);\n        });\n      }\n    };\n\n    return _this;\n  }\n\n  _createClass(ForgotPassword, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      ValidatorForm.addValidationRule('isPasswordMatch', function (value) {\n        if (value !== _this2.state.newPassword) {\n          return false;\n        }\n\n        return true;\n      });\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      // remove rule when it is not needed\n      ValidatorForm.removeValidationRule('isPasswordMatch');\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var _this$state = this.state,\n          email = _this$state.email,\n          emailCorrect = _this$state.emailCorrect,\n          newPassword = _this$state.newPassword,\n          confirmNewPassword = _this$state.confirmNewPassword,\n          token = _this$state.token;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"signup flex flex-center w-100 h-100vh\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"p-8\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(Card, {\n        className: \"signup-card position-relative y-center\",\n        style: {\n          top: '25vh'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(Grid, {\n        container: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(Grid, {\n        item: true,\n        lg: 5,\n        md: 5,\n        sm: 5,\n        xs: 12,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"p-32 flex flex-center flex-middle h-100\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: \"/assets/images/logos/logo_nimpe.jpg\",\n        alt: \"\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 19\n        }\n      }))), /*#__PURE__*/React.createElement(Grid, {\n        item: true,\n        lg: 7,\n        md: 7,\n        sm: 7,\n        xs: 12,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"p-24 h-100 bg-light-gray position-relative\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        style: {\n          fontSize: '16px',\n          paddingBottom: '20px'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 19\n        }\n      }, \"M\\u1EDDi b\\u1EA1n nh\\u1EADp email \\u0111\\u1EC3 l\\u1EA5y l\\u1EA1i m\\u1EADt kh\\u1EA9u: \"), /*#__PURE__*/React.createElement(ValidatorForm, {\n        ref: \"form\",\n        onSubmit: function onSubmit(e) {\n          return _this3.handleFormSubmit(e);\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(TextValidator, {\n        size: \"small\",\n        className: \"mb-24 w-100\",\n        variant: \"outlined\",\n        label: \"Email\",\n        onChange: this.handleChange,\n        type: \"email\",\n        name: \"email\",\n        value: email,\n        validators: [\"required\", \"isEmail\"],\n        errorMessages: [\"this field is required\", \"email is not valid\"],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 21\n        }\n      }), emailCorrect && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(TextValidator, {\n        size: \"small\",\n        className: \"mb-24 w-100\",\n        variant: \"outlined\",\n        label: \"OTP\",\n        onChange: this.handleChange,\n        type: \"text\",\n        name: \"token\",\n        value: token,\n        validators: [\"required\"],\n        errorMessages: [\"this field is required\"],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 25\n        }\n      }), /*#__PURE__*/React.createElement(TextValidator, {\n        size: \"small\",\n        className: \"mb-24 w-100\",\n        variant: \"outlined\",\n        label: \"M\\u1EADt kh\\u1EA9u\",\n        onChange: this.handleChange,\n        type: \"password\",\n        name: \"newPassword\",\n        value: newPassword,\n        validators: [\"required\", \"matchRegexp:^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-]).{8,}$\"],\n        errorMessages: [\"this field is required\", 'Mật khẩu có 8 ký tự bao gồm: Chữ hoa, chữ thường, số và ký tự đặc biệt'],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 25\n        }\n      }), /*#__PURE__*/React.createElement(TextValidator, {\n        size: \"small\",\n        className: \"mb-24 w-100\",\n        variant: \"outlined\",\n        label: \"Nh\\u1EADp l\\u1EA1i m\\u1EADt kh\\u1EA9u\",\n        onChange: this.handleChange,\n        type: \"password\",\n        name: \"confirmNewPassword\",\n        value: confirmNewPassword,\n        validators: [\"isPasswordMatch\", \"required\"],\n        errorMessages: [\"Mật khẩu không khớp\", \"this field is required\"],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 25\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"flex flex-middle\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(Suspense, {\n        fallback: /*#__PURE__*/React.createElement(\"h1\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 161,\n            columnNumber: 43\n          }\n        }, \"loading\"),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(Button, {\n        variant: \"contained\",\n        color: \"primary\",\n        type: \"button\",\n        onClick: this.handleFormSubmit,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 25\n        }\n      }, \"L\\u1EA5y l\\u1EA1i m\\u1EADt kh\\u1EA9u\"))), /*#__PURE__*/React.createElement(\"p\", {\n        className: \"text-muted\",\n        style: {\n          position: \"absolute\",\n          bottom: \"0\",\n          left: \"40%\",\n          transform: \"translateX(-40%)\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 21\n        }\n      }, \"B\\u1EA1n \\u0111\\xE3 c\\xF3 t\\xE0i kho\\u1EA3n?\", /*#__PURE__*/React.createElement(Link, {\n        to: \"/session/signin\",\n        className: \"text-primary font-weight-bold ml-10\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 23\n        }\n      }, \"\\u0110\\u0103ng nh\\u1EADp\")))))))), /*#__PURE__*/React.createElement(ToastContainer, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 9\n        }\n      }));\n    }\n  }]);\n\n  return ForgotPassword;\n}(Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    resetPassword: PropTypes.func.isRequired,\n    login: state.login\n  };\n};\n\nexport default withRouter(connect(mapStateToProps, {\n  resetPassword: resetPassword\n})(ForgotPassword));","map":{"version":3,"sources":["D:/OceanTech/nimpe/Client-V2/src/app/views/sessions/ForgotPassword.jsx"],"names":["React","Component","Suspense","ConstantList","Card","Grid","Button","withStyles","CircularProgress","TextValidator","ValidatorForm","connect","PropTypes","withRouter","forgotPassword","resetPassword","toast","ToastContainer","Redirect","Link","ForgotPassword","state","email","token","newPassword","confirmNewPassword","emailCorrect","handleChange","event","persist","setState","target","name","value","handleFormSubmit","e","t","props","then","data","console","log","success","catch","reason","response","status","error","message","code","setTimeout","history","push","ROOT_PATH","err","addValidationRule","removeValidationRule","top","fontSize","paddingBottom","position","bottom","left","transform","mapStateToProps","func","isRequired","login"],"mappings":"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","sourcesContent":["import React, { Component, Suspense } from \"react\";\nimport ConstantList from \"../../appConfig\";\nimport {\n  Card,\n  Grid,\n  Button,\n  withStyles,\n  CircularProgress\n} from \"@material-ui/core\";\nimport { TextValidator, ValidatorForm } from \"react-material-ui-form-validator\";\nimport { connect } from \"react-redux\";\nimport { PropTypes } from \"prop-types\";\nimport { withRouter } from \"react-router-dom\";\nimport { forgotPassword, resetPassword } from './SessionService';\n// import { resetPassword } from \"../../redux/actions/LoginActions\";\nimport { toast, ToastContainer } from 'react-toastify';\nimport { Redirect, Link } from 'react-router-dom';\n\nclass ForgotPassword extends Component {\n  state = {\n    email: '',\n    token: '',\n    newPassword: '',\n    confirmNewPassword: '',\n    emailCorrect: false\n  };\n\n  componentDidMount() {\n    ValidatorForm.addValidationRule('isPasswordMatch', (value) => {\n      if (value !== this.state.newPassword) {\n        return false;\n      }\n      return true;\n    });\n  }\n  handleChange = event => {\n    event.persist();\n    this.setState({\n      [event.target.name]: event.target.value\n    });\n  };\n\n  handleFormSubmit = (e) => {\n    let { t } = this.props;\n    if (!this.state.emailCorrect) {\n      forgotPassword({ email: this.state.email }).then((data) => {\n        console.log(data);\n        toast.success('Kiểm tra OTP trong email đăng ký');\n        this.setState({\n          emailCorrect: true\n        });\n      }).catch((reason) => {\n        if (reason.response?.status === 400) {\n          toast.error('Email không tồn tại');\n        } else {\n          toast.error('Có lỗi xảy ra');\n        }\n        console.log(reason.message);\n      })\n    }\n     else {\n      resetPassword({...this.state}).then((data) => {\n        console.log(data)\n        if(data.data.code === 200){\n        toast.success('Thay đổi mật khẩu thành công');\n        setTimeout(()=>{\n          this.props.history.push(ConstantList.ROOT_PATH + \"session/signin\")\n        }, 1000)\n        \n        }else{\n          toast.error(`Thông tin không chính xác`);\n        }\n      }).catch((err) => {\n        toast.error(err.message);\n      })\n    }\n  };\n  componentWillUnmount() {\n    // remove rule when it is not needed\n    ValidatorForm.removeValidationRule('isPasswordMatch');\n  }\n  render() {\n    let { email, emailCorrect, newPassword, confirmNewPassword, token } = this.state;\n    return (\n      <div className=\"signup flex flex-center w-100 h-100vh\">\n        <div className=\"p-8\">\n          <Card className=\"signup-card position-relative y-center\" style={{top:'25vh'}}>\n            <Grid container>\n              <Grid item lg={5} md={5} sm={5} xs={12}>\n                <div className=\"p-32 flex flex-center flex-middle h-100\">\n                  <img src={\"/assets/images/logos/logo_nimpe.jpg\"} alt=\"\" />\n                </div>\n              </Grid>\n              <Grid item lg={7} md={7} sm={7} xs={12}>\n                <div className=\"p-24 h-100 bg-light-gray position-relative\">\n                  <p style={{fontSize: '16px', paddingBottom: '20px'}}>Mời bạn nhập email để lấy lại mật khẩu: </p>\n                  <ValidatorForm ref=\"form\" onSubmit={(e) => this.handleFormSubmit(e)}>\n                    <TextValidator\n                      size=\"small\"\n                      className=\"mb-24 w-100\"\n                      variant=\"outlined\"\n                      label=\"Email\"\n                      onChange={this.handleChange}\n                      type=\"email\"\n                      name=\"email\"\n                      value={email}\n                      validators={[\"required\", \"isEmail\"]}\n                      errorMessages={[\n                        \"this field is required\",\n                        \"email is not valid\"\n                      ]}\n                    />\n                    {\n                      emailCorrect && <>\n                        <TextValidator\n                          size=\"small\"\n                          className=\"mb-24 w-100\"\n                          variant=\"outlined\"\n                          label=\"OTP\"\n                          onChange={this.handleChange}\n                          type=\"text\"\n                          name=\"token\"\n                          value={token}\n                          validators={[\"required\"]}\n                          errorMessages={[\n                            \"this field is required\"\n                          ]}\n                        />\n                        <TextValidator\n                          size=\"small\"\n                          className=\"mb-24 w-100\"\n                          variant=\"outlined\"\n                          label=\"Mật khẩu\"\n                          onChange={this.handleChange}\n                          type=\"password\"\n                          name=\"newPassword\"\n                          value={newPassword}\n                          validators={[\"required\", \"matchRegexp:^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-]).{8,}$\"]}\n                          errorMessages={[\n                            \"this field is required\", 'Mật khẩu có 8 ký tự bao gồm: Chữ hoa, chữ thường, số và ký tự đặc biệt'\n                          ]}\n                        />\n\n                        <TextValidator\n                          size=\"small\"\n                          className=\"mb-24 w-100\"\n                          variant=\"outlined\"\n                          label=\"Nhập lại mật khẩu\"\n                          onChange={this.handleChange}\n                          type=\"password\"\n                          name=\"confirmNewPassword\"\n                          value={confirmNewPassword}\n                          validators={[\"isPasswordMatch\", \"required\"]}\n                          errorMessages={[\n                            \"Mật khẩu không khớp\", \"this field is required\"\n                          ]}\n                        />\n                      </>\n                    }\n                    <div className=\"flex flex-middle\">\n                      <Suspense fallback={<h1>loading</h1>}>\n                        <Button variant=\"contained\" color=\"primary\" type=\"button\" onClick={this.handleFormSubmit}>\n                          Lấy lại mật khẩu\n                        </Button>\n                      </Suspense>\n                    </div>\n                    <p className=\"text-muted\" style={{ position: \"absolute\", bottom: \"0\",  left: \"40%\", transform: \"translateX(-40%)\"}}>\n                      Bạn đã có tài khoản?  \n                      <Link to=\"/session/signin\" className=\"text-primary font-weight-bold ml-10\">\n                        Đăng nhập\n                      </Link>\n                    </p>\n                  </ValidatorForm>\n                </div>\n              </Grid>\n            </Grid>\n          </Card>\n        </div>\n        <ToastContainer />\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = state => ({\n  resetPassword: PropTypes.func.isRequired,\n  login: state.login\n});\nexport default withRouter(\n  connect(\n    mapStateToProps,\n    { resetPassword }\n  )(ForgotPassword)\n);\n"]},"metadata":{},"sourceType":"module"}