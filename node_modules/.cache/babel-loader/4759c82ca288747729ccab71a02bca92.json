{"ast":null,"code":"import _defineProperty from \"D:\\\\OceanTech\\\\nimpe\\\\Client-V2\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"D:\\\\OceanTech\\\\nimpe\\\\Client-V2\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"D:\\\\OceanTech\\\\nimpe\\\\Client-V2\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _inherits from \"D:\\\\OceanTech\\\\nimpe\\\\Client-V2\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _createSuper from \"D:\\\\OceanTech\\\\nimpe\\\\Client-V2\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"D:\\\\OceanTech\\\\nimpe\\\\Client-V2\\\\src\\\\app\\\\views\\\\sessions\\\\OTPAuthentication.jsx\";\nimport React, { Component } from \"react\";\nimport { Card, Grid, Button } from \"@material-ui/core\";\nimport { ValidatorForm, TextValidator } from \"react-material-ui-form-validator\";\nimport { checkOTP } from \"./SessionService\";\nimport { connect } from \"react-redux\";\nimport { Helmet } from 'react-helmet';\nimport { Redirect, Link } from 'react-router-dom';\nimport { toast } from \"react-toastify\";\nimport \"react-toastify/dist/ReactToastify.css\";\ntoast.configure({\n  autoClose: 2000,\n  draggable: false,\n  limit: 3\n});\n\nvar OTPAuthentication = /*#__PURE__*/function (_Component) {\n  _inherits(OTPAuthentication, _Component);\n\n  var _super = _createSuper(OTPAuthentication);\n\n  function OTPAuthentication(props) {\n    var _this;\n\n    _classCallCheck(this, OTPAuthentication);\n\n    _this = _super.call(this, props);\n\n    _this.handleChange = function (event, source) {\n      event.persist();\n\n      if (source === 'switch') {\n        _this.setState({\n          isActive: event.target.checked\n        });\n\n        return;\n      }\n\n      if (source === 'token') {\n        var token = _this.state;\n        token = event.target.value;\n\n        _this.setState({\n          token: token\n        });\n      }\n\n      _this.setState(_defineProperty({}, event.target.name, event.target.value));\n    };\n\n    _this.openSelectDepartmentPopup = function () {\n      _this.setState({\n        shouldOpenSelectDepartmentPopup: true\n      });\n    };\n\n    _this.handleFormSubmit = function (event) {\n      var registerDto = {};\n      var email = _this.props.match.params.email;\n      registerDto.token = _this.state.token;\n      registerDto.email = _this.props.match.params.email;\n\n      if (_this.state.token.length == 5) {\n        if (email) {\n          checkOTP(registerDto).then(function (result) {\n            var _result$data, _result$data2;\n\n            if (((_result$data = result.data) === null || _result$data === void 0 ? void 0 : _result$data.data) == true && ((_result$data2 = result.data) === null || _result$data2 === void 0 ? void 0 : _result$data2.code) === 200) {\n              toast.success('Đăng ký thành công.');\n\n              _this.props.history.push('/session/signin');\n            } else {\n              toast.error('Có lỗi xảy ra khi đăng ký.');\n            }\n          }, function (error) {\n            toast.error('Có lỗi xảy ra khi đăng ký.');\n          });\n        } else {\n          toast.error(\"Email không tồn tại\");\n        }\n      } else {\n        toast.error(\"Mã OTP nhập vào không đúng quy định!\");\n      }\n    };\n\n    _this.state = {\n      token: \"\"\n    };\n    return _this;\n  }\n\n  _createClass(OTPAuthentication, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      // custom rule will have name 'isPasswordMatch'\n      ValidatorForm.addValidationRule('isPasswordMatch', function (value) {\n        if (value !== _this2.state.password) {\n          return false;\n        }\n\n        return true;\n      });\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      // remove rule when it is not needed\n      ValidatorForm.removeValidationRule('isPasswordMatch');\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var _this$props = this.props,\n          open = _this$props.open,\n          handleClose = _this$props.handleClose,\n          handleOKEditClose = _this$props.handleOKEditClose,\n          t = _this$props.t,\n          i18n = _this$props.i18n;\n      var token = this.state.token;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"signup flex flex-center w-100 h-100vh\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(Helmet, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"title\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 11\n        }\n      }, t('Dashboard.otpAuthentication'), \" | \", t('web_site'), \" \")), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"p-8\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(Card, {\n        className: \"signup-card position-relative y-center\",\n        style: {\n          top: '30vh'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(Grid, {\n        container: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(Grid, {\n        item: true,\n        lg: 5,\n        md: 5,\n        sm: 5,\n        xs: 12,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"p-32 flex flex-center flex-middle h-100 logo-login\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: \"/assets/images/logos/logo_nimpe.jpg\",\n        alt: \"\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 19\n        }\n      }))), /*#__PURE__*/React.createElement(Grid, {\n        item: true,\n        lg: 7,\n        md: 7,\n        sm: 7,\n        xs: 12,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"p-36 h-100 bg-light-gray position-relative\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        style: {\n          textAlign: 'center'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 19\n        }\n      }, \"M\\u1EDDi b\\u1EA1n nh\\u1EADp m\\xE3 x\\xE1c th\\u1EF1c OTP \\u0111\\xE3 \\u0111\\u01B0\\u1EE3c g\\u1EEDi \\u0111\\u1EBFn email c\\u1EE7a b\\u1EA1n:\"), /*#__PURE__*/React.createElement(ValidatorForm, {\n        ref: \"form\",\n        onSubmit: this.handleFormSubmit,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(TextValidator, {\n        className: \"w-100 mb-16\",\n        size: \"small\",\n        label: /*#__PURE__*/React.createElement(\"span\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 117,\n            columnNumber: 30\n          }\n        }, /*#__PURE__*/React.createElement(\"span\", {\n          style: {\n            color: \"red\"\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 117,\n            columnNumber: 36\n          }\n        }, \"*\"), t('user.otpCode')),\n        onChange: function onChange(token) {\n          return _this3.handleChange(token, 'token');\n        },\n        variant: \"outlined\",\n        type: \"text\",\n        name: \"token\",\n        value: token,\n        validators: ['required'],\n        errorMessages: ['This field is required'],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 21\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"flex flex-middle mb-8\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(Button, {\n        className: \"capitalize\",\n        variant: \"contained\",\n        color: \"primary\",\n        type: \"submit\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 23\n        }\n      }, t(\"sign_up.title\"))), /*#__PURE__*/React.createElement(\"p\", {\n        className: \"text-muted\",\n        style: {\n          position: \"absolute\",\n          bottom: \"0\",\n          left: \"45%\",\n          transform: \"translateX(-45%)\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 21\n        }\n      }, \"B\\u1EA1n \\u0111\\xE3 c\\xF3 t\\xE0i kho\\u1EA3n?\", /*#__PURE__*/React.createElement(Link, {\n        to: \"/session/signin\",\n        className: \"text-primary font-weight-bold ml-1\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 23\n        }\n      }, \"\\u0110\\u0103ng nh\\u1EADp\")))))))));\n    }\n  }]);\n\n  return OTPAuthentication;\n}(Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {// setUser: PropTypes.func.isRequired\n  };\n};\n\nexport default connect(mapStateToProps, {})(OTPAuthentication);","map":{"version":3,"sources":["D:/OceanTech/nimpe/Client-V2/src/app/views/sessions/OTPAuthentication.jsx"],"names":["React","Component","Card","Grid","Button","ValidatorForm","TextValidator","checkOTP","connect","Helmet","Redirect","Link","toast","configure","autoClose","draggable","limit","OTPAuthentication","props","handleChange","event","source","persist","setState","isActive","target","checked","token","state","value","name","openSelectDepartmentPopup","shouldOpenSelectDepartmentPopup","handleFormSubmit","registerDto","email","match","params","length","then","result","data","code","success","history","push","error","addValidationRule","password","removeValidationRule","open","handleClose","handleOKEditClose","t","i18n","top","textAlign","color","position","bottom","left","transform","mapStateToProps"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport {\r\n  Card,\r\n  Grid,\r\n  Button,\r\n} from \"@material-ui/core\";\r\nimport { ValidatorForm, TextValidator } from \"react-material-ui-form-validator\";\r\nimport {  checkOTP } from \"./SessionService\";\r\nimport { connect } from \"react-redux\";\r\nimport { Helmet } from 'react-helmet';\r\nimport { Redirect, Link } from 'react-router-dom';\r\nimport { toast } from \"react-toastify\";\r\nimport \"react-toastify/dist/ReactToastify.css\";\r\n\r\ntoast.configure({\r\n  autoClose: 2000,\r\n  draggable: false,\r\n  limit: 3,\r\n});\r\n\r\nclass OTPAuthentication extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      token: \"\",\r\n    };\r\n  }\r\n\r\n  handleChange = (event, source) => {\r\n    event.persist()\r\n    if (source === 'switch') {\r\n      this.setState({ isActive: event.target.checked })\r\n      return\r\n    }\r\n    if(source === 'token'){\r\n        let token = this.state;\r\n        token = event.target.value;\r\n        this.setState({ token: token })\r\n    }\r\n    this.setState({\r\n      [event.target.name]: event.target.value,\r\n    })\r\n  }\r\n  \r\n  openSelectDepartmentPopup = () => {\r\n    this.setState({\r\n      shouldOpenSelectDepartmentPopup: true,\r\n    })\r\n  }\r\n\r\n  handleFormSubmit = (event) => {\r\n    let registerDto = {};\r\n    let email = this.props.match.params.email;\r\n    registerDto.token = this.state.token;\r\n    registerDto.email = this.props.match.params.email;\r\n    if(this.state.token.length == 5) {\r\n      if(email){\r\n        checkOTP(registerDto).then((result) => {\r\n          if (result.data?.data == true && result.data?.code === 200) {\r\n            toast.success('Đăng ký thành công.');\r\n            this.props.history.push('/session/signin');\r\n          }\r\n          else {\r\n            toast.error('Có lỗi xảy ra khi đăng ký.');\r\n          }\r\n        }, (error) => {\r\n          toast.error('Có lỗi xảy ra khi đăng ký.');\r\n        });\r\n      } else {\r\n        toast.error(\"Email không tồn tại\");\r\n      } \r\n    } else {\r\n      toast.error(\"Mã OTP nhập vào không đúng quy định!\")\r\n    }\r\n  };\r\n\r\n  componentDidMount() {\r\n    // custom rule will have name 'isPasswordMatch'\r\n    ValidatorForm.addValidationRule('isPasswordMatch', (value) => {\r\n      if (value !== this.state.password) {\r\n        return false;\r\n      }\r\n      return true;\r\n    });\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    // remove rule when it is not needed\r\n    ValidatorForm.removeValidationRule('isPasswordMatch');\r\n  }\r\n\r\n  render() {\r\n    let { open, handleClose, handleOKEditClose, t, i18n } = this.props\r\n    let {\r\n      token\r\n    } = this.state;\r\n    return (\r\n      <div className=\"signup flex flex-center w-100 h-100vh\">\r\n        <Helmet>\r\n          <title>{t('Dashboard.otpAuthentication')} | {t('web_site')} </title>\r\n        </Helmet>\r\n        <div className=\"p-8\">\r\n          <Card className=\"signup-card position-relative y-center\" style={{top: '30vh'}}>\r\n            <Grid container>\r\n              <Grid item lg={5} md={5} sm={5} xs={12}>\r\n                <div className=\"p-32 flex flex-center flex-middle h-100 logo-login\">\r\n                  <img src={\"/assets/images/logos/logo_nimpe.jpg\"} alt=\"\" />\r\n                </div>\r\n              </Grid>\r\n              <Grid item lg={7} md={7} sm={7} xs={12}>\r\n                <div className=\"p-36 h-100 bg-light-gray position-relative\">\r\n                  <p style={{textAlign: 'center'}}>Mời bạn nhập mã xác thực OTP đã được gửi đến email của bạn:</p>\r\n                  <ValidatorForm ref=\"form\" onSubmit={this.handleFormSubmit}>\r\n                    <TextValidator\r\n                      className=\"w-100 mb-16\"\r\n                      size=\"small\"\r\n                      label={<span><span style={{ color: \"red\" }}>*</span>{t('user.otpCode')}</span>}\r\n                      onChange={(token) =>\r\n                        this.handleChange(token, 'token')\r\n                      }\r\n                      variant=\"outlined\"\r\n                      type=\"text\"\r\n                      name=\"token\"\r\n                      value={token}\r\n                      validators={['required']}\r\n                      errorMessages={['This field is required']}\r\n                    />\r\n\r\n                    <div className=\"flex flex-middle mb-8\">\r\n                      <Button\r\n                        className=\"capitalize\"\r\n                        variant=\"contained\"\r\n                        color=\"primary\"\r\n                        type=\"submit\"\r\n                      >\r\n                        {t(\"sign_up.title\")}\r\n                      </Button>\r\n                    </div>\r\n                    <p className=\"text-muted\" style={{ position: \"absolute\", bottom: \"0\",  left: \"45%\", transform: \"translateX(-45%)\"}}>\r\n                      Bạn đã có tài khoản? \r\n                      <Link to=\"/session/signin\" className=\"text-primary font-weight-bold ml-1\">\r\n                        Đăng nhập\r\n                      </Link>\r\n                    </p>\r\n                  </ValidatorForm>\r\n                </div>\r\n              </Grid>\r\n            </Grid>\r\n          </Card>     \r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  // setUser: PropTypes.func.isRequired\r\n});\r\n\r\nexport default connect(\r\n  mapStateToProps,\r\n  {}\r\n)(OTPAuthentication);\r\n"]},"metadata":{},"sourceType":"module"}