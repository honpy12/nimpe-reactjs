(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{1610:function(e,a,t){"use strict";var n=t(381),r=t(25),l=t(26),s=t(40),i=t(41),o=t(1603),c=t(1507),d=t(1666),m=t(0),u=t.n(m),h=t(1487),p=t(1614),g=["errorMessages","validators","requiredError","helperText","validatorListener"],f=function(e){Object(s.a)(t,e);var a=Object(i.a)(t);function t(){return Object(r.a)(this,t),a.apply(this,arguments)}return Object(l.a)(t,[{key:"renderValidatorComponent",value:function(){var e=this.props,a=(e.errorMessages,e.validators,e.requiredError,e.helperText),t=(e.validatorListener,Object(n.a)(e,g)),r=this.state.isValid;return u.a.createElement(c.a,{utils:o.a,locale:p.a},u.a.createElement(d.a,Object.assign({},t,{error:!r,helperText:!r&&this.getErrorMessage()||a})))}}]),t}(h.ValidatorComponent);a.a=f},1894:function(e,a,t){"use strict";t.r(a);var n=t(366),r=t(5),l=t(25),s=t(26),i=t(40),o=t(41),c=t(1335),d=t(223),m=t(1453),u=t(1502),h=t(1513),p=t(1520),g=t(1498),f=t(1333),v=t(16),b=t(1611),E=t(1612),w=t(0),C=t.n(w),y=t(1487),O=t(1452),j=(t(591),t(1)),N=t.n(j),P=t(103),S=t(55),x=t(1610),D=t(1331),U=t(1461),k=t(1458),T=t(1332),I=t(1492),L=t.n(I),F=(t(1733),t(15)),R=t.n(F),V=N.a.API_ENPOINT+"/api/users",M=function(){var e=V+"/getCurrentUser";return R.a.get(e)},W=function(e){return R.a.put(V,e)},A=function(e){return R.a.put(V+"/password/self",e)},_=function(e){return R.a.post(V+"/updateavatar",e,{"Content-Type":"multipart/form-data"})};function q(e){return C.a.createElement(L.a,{handle:"#draggable-dialog-title",cancel:'[class*="MuiDialogContent-root"]'},C.a.createElement(d.a,e))}var z=function(e){Object(i.a)(t,e);var a=Object(o.a)(t);function t(){var e;Object(l.a)(this,t);for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return(e=a.call.apply(a,[this].concat(s))).state={oldPassword:"",password:"",confirmPassword:""},e.handleChangePassword=function(){A(e.state).then(function(){O.b.success("B\u1ea1n \u0111\xe3 \u0111\u1ed1i m\u1eadt kh\u1ea9u th\xe0nh c\xf4ng"),setTimeout(function(){P.a.logout()},2e3)}).catch(function(){O.b.error("\u0110\xe3 c\xf3 l\u1ed7i khi \u0111\u1ed5i m\u1eadt kh\u1ea9u"),e.props.handleClose()})},e.handleChange=function(a){return function(t){e.setState(Object(n.a)({},a,t.target.value))}},e}return Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;y.ValidatorForm.addValidationRule("isPasswordMatch",function(a){return a===e.state.password}),this.props.user&&this.setState(Object(r.a)({},this.props.user))}},{key:"render",value:function(){var e=this,a=this.props,t=a.t,n=a.handleClose,r=a.open;a.user;return C.a.createElement(D.a,{onClose:n,open:r,PaperProps:{style:{width:500,maxHeight:800,alignContent:"center"}},PaperComponent:q,maxWidth:"md",fullWidth:!0},C.a.createElement(U.a,{style:{cursor:"move"},id:"draggable-dialog-title"},t("user.changePass")),C.a.createElement(y.ValidatorForm,{ref:"form",onSubmit:function(){return e.handleChangePassword()}},C.a.createElement(k.a,{dividers:!0},C.a.createElement(c.a,{container:!0,spacing:1},C.a.createElement(c.a,{item:!0,md:12,sm:12,xs:12},C.a.createElement(u.a,{fullWidth:!0,margin:"dense"},C.a.createElement(y.TextValidator,{label:C.a.createElement("span",null,C.a.createElement("span",{style:{color:"red"}},"*"),t("user.current_password")),id:"password-current",className:"w-100",name:"oldPassword",type:"password",value:this.state.oldPassword,onChange:this.handleChange("oldPassword"),validators:["required"],errorMessages:[t("general.required")]}))),C.a.createElement(c.a,{item:!0,md:12,sm:12,xs:12},C.a.createElement(u.a,{fullWidth:!0,margin:"dense"},C.a.createElement(y.TextValidator,{label:C.a.createElement("span",null,C.a.createElement("span",{style:{color:"red"}},"*"),t("user.pass")),id:"password-current",className:"w-100",name:"password",type:"password",value:this.state.password,onChange:this.handleChange("password"),validators:["required"],errorMessages:[t("general.required")]}))),C.a.createElement(c.a,{item:!0,md:12,sm:12,xs:12},C.a.createElement(u.a,{fullWidth:!0,margin:"dense"},C.a.createElement(y.TextValidator,{label:C.a.createElement("span",null,C.a.createElement("span",{style:{color:"red"}},"*"),t("user.re_pass")),id:"confirm-password",className:"w-100",name:"confirmPassword",type:"password",value:this.state.confirmPassword,onChange:this.handleChange("confirmPassword"),validators:["required","isPasswordMatch"],errorMessages:[t("general.required"),t("user.passwordMatchMessage")]}))))),C.a.createElement(T.a,null,C.a.createElement(f.a,{className:"mr-12 align-bottom",variant:"contained",color:"secondary",onClick:function(){return n()}},t("general.cancel")),C.a.createElement(f.a,{className:"mr-16",variant:"contained",color:"primary",type:"submit"},t("general.update")))))}}]),t}(w.Component),H=t(66),B=t.n(H),J=t(117),K=t(13),G=t(1323),Q=t(1793),X=t.n(Q);function Y(e){return C.a.createElement(L.a,{handle:"#draggable-dialog-title",cancel:'[class*="MuiDialogContent-root"]'},C.a.createElement(d.a,e))}var Z=function(e){Object(i.a)(t,e);var a=Object(o.a)(t);function t(){var e;Object(l.a)(this,t);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(e=a.call.apply(a,[this].concat(s))).state={dragClass:"",files:[],statusList:[],isEmpty:!0,src:null,crop:{unit:"%",width:50,height:50},blobValue:null,contentType:null},e.onImageLoaded=function(a){e.imageRef=a},e.onCropComplete=function(a){e.makeClientCrop(a)},e.onCropChange=function(a){e.setState({crop:a})},e.handleFileUploadOnSelect=function(a){if(a.target.files&&a.target.files.length>0){var t=new FileReader;t.addEventListener("load",function(){return e.setState({src:t.result})}),t.readAsDataURL(a.target.files[0])}},e.handleFileSelect=function(a){if(a.target.files&&a.target.files.length>0){var t=new FileReader;t.addEventListener("load",function(){return e.setState({src:t.result,isEmpty:!1})}),t.readAsDataURL(a.target.files[0])}},e.handleDragOver=function(a){a.preventDefault(),e.setState({dragClass:"drag-shadow"})},e.handleDrop=function(a){a.preventDefault(),a.persist();var t=a.dataTransfer.files;if(t&&t.length>0){var n=new FileReader;n.addEventListener("load",function(){return e.setState({src:n.result})}),n.readAsDataURL(t[0])}return!1},e.handleDragStart=function(){e.setState({dragClass:"drag-shadow"})},e.handleSingleRemove=function(a){var t=Object(K.a)(e.state.files);t.splice(a,1),e.setState({files:Object(K.a)(t)})},e.handleAllRemove=function(){e.setState({files:[]})},e.uploadSingleFile=function(a){var t=e.props.t,n=Object(K.a)(e.state.files),l=e.state.files[a];e.fileUpload(l.file).then(function(){alert(t("general.success")),window.location.reload()}),n[a]=Object(r.a)(Object(r.a)({},l),{},{uploading:!0,error:!1}),e.setState({files:Object(K.a)(n)})},e.uploadAllFile=function(){var a=[];e.state.files.map(function(e){return a.push(Object(r.a)(Object(r.a)({},e),{},{uploading:!0,error:!1})),e}),e.setState({files:[].concat(a),queProgress:35})},e.handleSingleCancel=function(a){var t=Object(K.a)(e.state.files),n=e.state.files[a];t[a]=Object(r.a)(Object(r.a)({},n),{},{uploading:!1,error:!0}),e.setState({files:Object(K.a)(t)})},e.fileUploadBlob=function(){var a=N.a.API_ENPOINT+"/api/users/updateavatar",t=new FormData;t.set("uploadfile",e.state.blobValue);return R.a.post(a,t,{headers:{"Content-Type":"image/jpg"}}).then(function(a){var t=a.data;e.setState({user:t})})},e}return Object(s.a)(t,[{key:"makeClientCrop",value:function(){var e=Object(J.a)(B.a.mark(function e(a){var t;return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.imageRef&&a.width&&a.height)){e.next=5;break}return e.next=3,this.getCroppedImg(this.imageRef,a,"newFile.jpeg");case 3:t=e.sent,this.setState({croppedImageUrl:t});case 5:case"end":return e.stop()}},e,this)}));return function(a){return e.apply(this,arguments)}}()},{key:"getCroppedImg",value:function(e,a,t){var n=this,r=document.createElement("canvas"),l=e.naturalWidth/e.width,s=e.naturalHeight/e.height;return r.width=a.width,r.height=a.height,r.getContext("2d").drawImage(e,a.x*l,a.y*s,a.width*l,a.height*s,0,0,a.width,a.height),new Promise(function(e){r.toBlob(function(a){a?(a.name=t,window.URL.revokeObjectURL(n.fileUrl),n.fileUrl=window.URL.createObjectURL(a),n.setState({blobValue:a}),e(n.fileUrl)):console.error("Canvas is empty")},"image/jpeg")})}},{key:"fileUpload",value:function(e){var a=this.props.uploadUrl,t=new FormData;t.append("uploadfile",e);return R.a.post(a,t,{headers:{"Content-Type":"multipart/form-data"}})}},{key:"render",value:function(){var e=this,a=this.props,t=a.t,n=a.handleClose,r=a.open,l=a.handleUpdate,s=this.state,i=s.dragClass,o=s.files;return C.a.createElement(D.a,{onClose:n,open:r,PaperProps:{style:{width:500,maxHeight:800,alignContent:"center"}},PaperComponent:Y,maxWidth:"md",fullWidth:!0},C.a.createElement(U.a,{style:{cursor:"move"},id:"draggable-dialog-title"},C.a.createElement("span",{className:"mb-20"},t("general.upload"))),C.a.createElement(k.a,null,C.a.createElement("div",{className:"upload-form m-sm-30"},this.state.isEmpty?C.a.createElement("div",null,C.a.createElement("div",{className:"".concat(i," upload-drop-box flex flex-center flex-middle"),onDragEnter:this.handleDragStart,onDragOver:this.handleDragOver,onDrop:this.handleDrop},this.state.isEmpty?C.a.createElement("span",null,"Drop your files here"):C.a.createElement("h5",{className:"m-0"},o.length," file",o.length>1?"s":""," ","selected...")),C.a.createElement("div",{className:"flex flex-wrap mb-20"},C.a.createElement("label",{htmlFor:"upload-single-file"},C.a.createElement(f.a,{size:"small",className:"capitalize",component:"span",variant:"contained",color:"primary"},C.a.createElement("div",{className:"flex flex-middle"},C.a.createElement(G.a,{className:"pr-8"},"cloud_upload"),C.a.createElement("span",null,t("general.select_file"))))),C.a.createElement("input",{className:"display-none",onChange:this.handleFileSelect,id:"upload-single-file",type:"file",accept:"image/*"}))):C.a.createElement("div",null,this.state.src&&C.a.createElement(X.a,{style:{maxWidth:"100%",maxHeight:400,alignContent:"center"},src:this.state.src,crop:this.state.crop,onImageLoaded:this.onImageLoaded,onComplete:this.onCropComplete,onChange:this.onCropChange})))),C.a.createElement(T.a,null,C.a.createElement(f.a,{className:"mb-16 mr-16 align-bottom",variant:"contained",color:"secondary",startIcon:C.a.createElement(b.a,null),onClick:function(){return n(e.state.user)}},t("general.close")),C.a.createElement(f.a,{className:"mb-16 mr-16 align-bottom",variant:"contained",startIcon:C.a.createElement(E.a,null),color:"primary",onClick:function(){return l(e.state.blobValue)}},t("general.update"))))}}]),t}(C.a.Component),$=N.a.API_ENPOINT+"/api/fileUpload/",ee=function(e){Object(i.a)(t,e);var a=Object(o.a)(t);function t(){var e;Object(l.a)(this,t);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return(e=a.call.apply(a,[this].concat(i))).state={open:!0,user:{person:{}},shouldOpenImageDialog:!1,shouldOpenPasswordDialog:!1,isUpdate:!1},e.toggleSidenav=function(){e.setState({open:!e.state.open})},e.handleWindowResize=function(){return function(a){a.target.innerWidth<768?e.setState({mobile:!0}):e.setState({mobile:!1})}},e.handleOpenUploadDialog=function(){e.setState({shouldOpenImageDialog:!0})},e.handleDialogClose=function(){e.setState({shouldOpenImageDialog:!1})},e.handleOpenPasswordDialog=function(){e.setState({shouldOpenPasswordDialog:!0})},e.handleDialogPasswordClose=function(){e.setState({shouldOpenPasswordDialog:!1})},e.openPasswordDialog=function(){e.setState({shouldOpenPasswordDialog:!0})},e.handleUpdate=function(a){var t=new FormData;t.set("uploadfile",a),_(t).then(function(a){var t=a.data;e.setState({user:t}),P.a.setLoginUser(t),e.handleDialogClose()})},e.handleUserChange=function(a){e.setState({user:Object(r.a)(Object(r.a)({},e.state.user),{},Object(n.a)({},a.target.name,a.target.value))})},e.handlePersonChange=function(a){e.setState({user:Object(r.a)(Object(r.a)({},e.state.user),{},{person:Object(r.a)(Object(r.a)({},e.state.user.person),{},Object(n.a)({},a.target.name,a.target.value))})})},e.handleDateChange=function(a){e.setState({user:Object(r.a)(Object(r.a)({},e.state.user),{},{person:Object(r.a)(Object(r.a)({},e.state.user.person),{},{birthDate:a})})})},e.handleFormSubmit=function(){var a=e.props.t;W(e.state.user).then(function(){e.setState({isUpdate:!1}),O.b.success(a("general.updateSuccess"))}).catch(function(){return O.b.error(a("general.error"))})},e}return Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;M().then(function(a){var t=a.data;e.setState({user:t})}),window.innerWidth<768&&this.setState({open:!1}),window&&(this.windowResizeListener=window.addEventListener("resize",function(a){a.target.innerWidth<768?e.setState({open:!1}):e.setState({open:!0})}))}},{key:"componentWillUnmount",value:function(){var e=S.a.getLoginUser();M(),this.setState({user:e}),window&&window.removeEventListener("resize",this.windowResizeListener)}},{key:"render",value:function(){var e,a,t,n,r,l,s,i,o,v=this,w=this.props,O=w.t,j=w.i18n,P=this.state.user,S=this.state.user.person,D=this.state,U=D.isUpdate,k=D.shouldOpenImageDialog,T=D.shouldOpenPasswordDialog;return C.a.createElement("div",{className:"m-sm-30 ",t:O,i18n:j},k&&C.a.createElement(Z,{t:O,i18n:j,handleClose:this.handleDialogClose,handleUpdate:this.handleUpdate,open:k,uploadUrl:$+"avatarUpload",acceptType:"png;jpg;gif;jpeg"}),T&&C.a.createElement(z,{t:O,i18n:j,handleClose:this.handleDialogPasswordClose,open:T,user:P}),C.a.createElement("h4",null,O("user.person_info")),C.a.createElement(y.ValidatorForm,{ref:"form",onSubmit:this.handleFormSubmit},C.a.createElement(c.a,{container:!0,spacing:4,className:"mt-16"},C.a.createElement(c.a,{item:!0,xs:12,sm:4},C.a.createElement(d.a,{elevation:3,className:"px-12 py-30 flex-column flex-center flex-middle",style:{minHeight:"50vh"}},C.a.createElement(m.a,{className:"mb-30",style:{width:"150px",height:"150px",cursor:"pointer"},src:this.state.user?N.a.API_ENPOINT+this.state.user.imagePath:N.a.ROOT_PATH+"assets/images/avatar.jpg",onClick:this.handleOpenUploadDialog}),C.a.createElement("h4",null,null!==(e=null===S||void 0===S?void 0:S.displayName)&&void 0!==e?e:""))),C.a.createElement(c.a,{item:!0,xs:12,sm:7},C.a.createElement(d.a,{elevation:3,className:"px-12 py-30 flex-column flex-center flex-middle",style:{minHeight:"50vh"}},C.a.createElement(c.a,{item:!0,container:!0,spacing:2,alignItems:"center",className:"ml-16"},C.a.createElement(c.a,{item:!0,sm:6},C.a.createElement(y.TextValidator,{className:"w-90 mb-16",disabled:!U,label:O("user.firstName"),name:"firstName",value:null!==(a=null===S||void 0===S?void 0:S.firstName)&&void 0!==a?a:"",onChange:this.handlePersonChange})),C.a.createElement(c.a,{item:!0,sm:6},C.a.createElement(y.TextValidator,{disabled:!U,className:"w-90 mb-16",label:O("user.lastName"),value:null!==(t=null===S||void 0===S?void 0:S.lastName)&&void 0!==t?t:"",name:"lastName",onChange:this.handlePersonChange})),C.a.createElement(c.a,{item:!0,sm:6},C.a.createElement(y.TextValidator,{disabled:!U,className:"w-90 mb-16",label:O("user.displayName"),value:null!==(n=null===S||void 0===S?void 0:S.displayName)&&void 0!==n?n:"",name:"displayName",onChange:this.handlePersonChange})),C.a.createElement(c.a,{item:!0,sm:6},C.a.createElement(y.TextValidator,{className:"w-90 mb-16",disabled:!0,label:O("user.username"),value:null!==(r=P.username)&&void 0!==r?r:""})),C.a.createElement(c.a,{item:!0,sm:6},C.a.createElement(x.a,{disableToolbar:!0,className:"w-90",autoOk:!0,disabled:!U,label:O("user.birthdate"),variant:"inline",format:"dd/MM/yyyy",id:"date-picker-inline",value:null!==(l=null===S||void 0===S?void 0:S.birthDate)&&void 0!==l?l:Date.now(),onChange:this.handleDateChange})),C.a.createElement(c.a,{item:!0,sm:6},C.a.createElement(u.a,{disabled:!U,className:"w-50 mb-16"},C.a.createElement(h.a,{htmlFor:"gender-simple"},O("user.gender")),C.a.createElement(p.a,{value:null!==(s=null===S||void 0===S?void 0:S.gender)&&void 0!==s?s:"",onChange:this.handlePersonChange,name:"gender"},[{id:"M",name:"Nam"},{id:"F",name:"N\u1eef"},{id:"U",name:"Kh\xf4ng r\xf5"}].map(function(e){return C.a.createElement(g.a,{key:e.id,value:e.id},e.name)})))),C.a.createElement(c.a,{item:!0,sm:6},C.a.createElement(y.TextValidator,{className:"w-90 mb-16",disabled:!U,label:O("user.email"),value:null!==(i=null===P||void 0===P?void 0:P.email)&&void 0!==i?i:"",name:"email",onChange:this.handleUserChange,validators:["isEmail"],errorMessages:["Email kh\xf4ng h\u1ee3p l\u1ec7"]})),C.a.createElement(c.a,{item:!0,sm:6},C.a.createElement(y.TextValidator,{disabled:!U,className:"w-90 mb-16",label:O("user.address"),value:null!==(o=null===S||void 0===S?void 0:S.birthPlace)&&void 0!==o?o:"",name:"birthPlace",onChange:this.handlePersonChange}))))),C.a.createElement(c.a,{item:!0,md:4,lg:3,className:"flex"},C.a.createElement(f.a,{variant:"contained",color:"secondary",className:"mr-16",onClick:function(){return v.setState({isUpdate:!0})}},O("general.update")),C.a.createElement(f.a,{variant:"contained",color:"primary",type:"button",onClick:function(){return v.openPasswordDialog()}},O("user.changePass"))),C.a.createElement(c.a,{item:!0,md:5,lg:5,xl:5}),U&&C.a.createElement(c.a,{item:!0,sm:3,style:{position:"relative"}},C.a.createElement("div",{style:{position:"absolute",right:"16px"}},C.a.createElement(f.a,{variant:"contained",color:"secondary",startIcon:C.a.createElement(b.a,null),className:"mr-12",onClick:function(){return v.setState({isUpdate:!1})}},O("general.cancel")),C.a.createElement(f.a,{variant:"contained",color:"primary",type:"submit",startIcon:C.a.createElement(E.a,null)},O("general.save")))))))}}]),t}(w.Component);a.default=Object(v.a)({},{withTheme:!0})(ee)}}]);
//# sourceMappingURL=47.276f6cc7.chunk.js.map