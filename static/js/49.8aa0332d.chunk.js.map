{"version":3,"sources":["app/views/sessions/SessionService.js","app/views/sessions/OTPAuthentication.jsx"],"names":["__webpack_require__","d","__webpack_exports__","signUpAccount","checkuserName","checkEmail","forgotPassword","resetPassword","checkOTP","axios__WEBPACK_IMPORTED_MODULE_0__","axios__WEBPACK_IMPORTED_MODULE_0___default","n","_appConfig__WEBPACK_IMPORTED_MODULE_1__","_appConfig__WEBPACK_IMPORTED_MODULE_1___default","API_PATH","ConstantList","API_ENPOINT","item","url","axios","post","config","params","userName","username","console","log","put","email","toast","configure","autoClose","draggable","limit","OTPAuthentication","props","_this","Object","D_OceanTech_nimpe_Client_V2_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__","this","_super","call","handleChange","event","source","persist","token","state","target","value","setState","D_OceanTech_nimpe_Client_V2_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__","name","isActive","checked","openSelectDepartmentPopup","shouldOpenSelectDepartmentPopup","handleFormSubmit","registerDto","match","length","then","result","_result$data","_result$data2","data","code","success","history","push","error","_this2","ValidatorForm","addValidationRule","password","removeValidationRule","_this3","_this$props","t","open","handleClose","handleOKEditClose","i18n","react__WEBPACK_IMPORTED_MODULE_5___default","a","createElement","className","react_helmet__WEBPACK_IMPORTED_MODULE_12__","_material_ui_core__WEBPACK_IMPORTED_MODULE_6__","style","top","_material_ui_core__WEBPACK_IMPORTED_MODULE_7__","container","lg","md","sm","xs","src","alt","textAlign","react_material_ui_form_validator__WEBPACK_IMPORTED_MODULE_9__","ref","onSubmit","size","label","color","onChange","variant","type","validators","errorMessages","_material_ui_core__WEBPACK_IMPORTED_MODULE_8__","position","bottom","left","transform","react_router_dom__WEBPACK_IMPORTED_MODULE_13__","to","Component","connect"],"mappings":"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","file":"static/js/49.8aa0332d.chunk.js","sourcesContent":["import axios from \"axios\";\nimport ConstantList from \"../../appConfig\";\nconst API_PATH = ConstantList.API_ENPOINT + \"/public/api/\";\n\nexport const signUpAccount = item => {\n  var url = API_PATH + \"register\";\n  return axios.post(url, item);\n};\n\nexport const checkuserName = item => {  \n  const config = { params: { userName:  item.username } };\n  console.log(config)\n  var url = API_PATH + \"username\";\n  return axios.put(url,null,config);\n};\n\nexport const checkEmail = item => {\n  const config = { params: { email:  item.email } };\n  console.log(config)\n  var url = API_PATH + \"email\";\n  return axios.put(url, null, config);\n};\n\nexport const forgotPassword = email => {\n  let url = ConstantList.API_ENPOINT + '/public/api/forgot-password';\n  return axios.post(url, email);\n}\nexport const resetPassword = item => {\n  let url = 'http://localhost:8993/nimpe/public/api/OTP';\n  return axios.put(url, item);\n}\n\nexport const checkOTP = item => {\n  let url = ConstantList.API_ENPOINT + \"/public/api/OTP/register\"; \n  return axios.put(url, item);\n}","import React, { Component } from \"react\";\r\nimport {\r\n  Card,\r\n  Grid,\r\n  Button,\r\n} from \"@material-ui/core\";\r\nimport { ValidatorForm, TextValidator } from \"react-material-ui-form-validator\";\r\nimport {  checkOTP } from \"./SessionService\";\r\nimport { connect } from \"react-redux\";\r\nimport { Helmet } from 'react-helmet';\r\nimport { Redirect, Link } from 'react-router-dom';\r\nimport { toast } from \"react-toastify\";\r\nimport \"react-toastify/dist/ReactToastify.css\";\r\n\r\ntoast.configure({\r\n  autoClose: 2000,\r\n  draggable: false,\r\n  limit: 3,\r\n});\r\n\r\nclass OTPAuthentication extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      token: \"\",\r\n    };\r\n  }\r\n\r\n  handleChange = (event, source) => {\r\n    event.persist()\r\n    if (source === 'switch') {\r\n      this.setState({ isActive: event.target.checked })\r\n      return\r\n    }\r\n    if(source === 'token'){\r\n        let token = this.state;\r\n        token = event.target.value;\r\n        this.setState({ token: token })\r\n    }\r\n    this.setState({\r\n      [event.target.name]: event.target.value,\r\n    })\r\n  }\r\n  \r\n  openSelectDepartmentPopup = () => {\r\n    this.setState({\r\n      shouldOpenSelectDepartmentPopup: true,\r\n    })\r\n  }\r\n\r\n  handleFormSubmit = (event) => {\r\n    let registerDto = {};\r\n    let email = this.props.match.params.email;\r\n    registerDto.token = this.state.token;\r\n    registerDto.email = this.props.match.params.email;\r\n    if(this.state.token.length == 5) {\r\n      if(email){\r\n        checkOTP(registerDto).then((result) => {\r\n          if (result.data?.data == true && result.data?.code === 200) {\r\n            toast.success('Đăng ký thành công.');\r\n            this.props.history.push('/session/signin');\r\n          }\r\n          else {\r\n            toast.error('Có lỗi xảy ra khi đăng ký.');\r\n          }\r\n        }, (error) => {\r\n          toast.error('Có lỗi xảy ra khi đăng ký.');\r\n        });\r\n      } else {\r\n        toast.error(\"Email không tồn tại\");\r\n      } \r\n    } else {\r\n      toast.error(\"Mã OTP nhập vào không đúng quy định!\")\r\n    }\r\n  };\r\n\r\n  componentDidMount() {\r\n    // custom rule will have name 'isPasswordMatch'\r\n    ValidatorForm.addValidationRule('isPasswordMatch', (value) => {\r\n      if (value !== this.state.password) {\r\n        return false;\r\n      }\r\n      return true;\r\n    });\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    // remove rule when it is not needed\r\n    ValidatorForm.removeValidationRule('isPasswordMatch');\r\n  }\r\n\r\n  render() {\r\n    let { open, handleClose, handleOKEditClose, t, i18n } = this.props\r\n    let {\r\n      token\r\n    } = this.state;\r\n    return (\r\n      <div className=\"signup flex flex-center w-100 h-100vh\">\r\n        <Helmet>\r\n          <title>{t('Dashboard.otpAuthentication')} | {t('web_site')} </title>\r\n        </Helmet>\r\n        <div className=\"p-8\">\r\n          <Card className=\"signup-card position-relative y-center\" style={{top: '30vh'}}>\r\n            <Grid container>\r\n              <Grid item lg={5} md={5} sm={5} xs={12}>\r\n                <div className=\"p-32 flex flex-center flex-middle h-100 logo-login\">\r\n                  <img src={\"/assets/images/logos/logo_nimpe.jpg\"} alt=\"\" />\r\n                </div>\r\n              </Grid>\r\n              <Grid item lg={7} md={7} sm={7} xs={12}>\r\n                <div className=\"p-36 h-100 bg-light-gray position-relative\">\r\n                  <p style={{textAlign: 'center'}}>Mời bạn nhập mã xác thực OTP đã được gửi đến email của bạn:</p>\r\n                  <ValidatorForm ref=\"form\" onSubmit={this.handleFormSubmit}>\r\n                    <TextValidator\r\n                      className=\"w-100 mb-16\"\r\n                      size=\"small\"\r\n                      label={<span><span style={{ color: \"red\" }}>*</span>{t('user.otpCode')}</span>}\r\n                      onChange={(token) =>\r\n                        this.handleChange(token, 'token')\r\n                      }\r\n                      variant=\"outlined\"\r\n                      type=\"text\"\r\n                      name=\"token\"\r\n                      value={token}\r\n                      validators={['required']}\r\n                      errorMessages={['This field is required']}\r\n                    />\r\n\r\n                    <div className=\"flex flex-middle mb-8\">\r\n                      <Button\r\n                        className=\"capitalize\"\r\n                        variant=\"contained\"\r\n                        color=\"primary\"\r\n                        type=\"submit\"\r\n                      >\r\n                        {t(\"sign_up.title\")}\r\n                      </Button>\r\n                    </div>\r\n                    <p className=\"text-muted\" style={{ position: \"absolute\", bottom: \"0\",  left: \"45%\", transform: \"translateX(-45%)\"}}>\r\n                      Bạn đã có tài khoản? \r\n                      <Link to=\"/session/signin\" className=\"text-primary font-weight-bold ml-1\">\r\n                        Đăng nhập\r\n                      </Link>\r\n                    </p>\r\n                  </ValidatorForm>\r\n                </div>\r\n              </Grid>\r\n            </Grid>\r\n          </Card>     \r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  // setUser: PropTypes.func.isRequired\r\n});\r\n\r\nexport default connect(\r\n  mapStateToProps,\r\n  {}\r\n)(OTPAuthentication);\r\n"],"sourceRoot":""}